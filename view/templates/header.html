<header>
  <div class="nav-left">
    <a href="/" class="logo" title="Inicio">UnderSounds</a>
  </div>
  <div class="nav-center">
    <a href="/generos" id="btnGeneros" class="btn-icon" title="Buscar por g√©neros">üí°</a>


    <div class="search-container">
      <form action="/search" method="get" class="search-form">
        <input type="text" id="searchInput" name="q" placeholder="Buscar artista, √°lbum,...">
        <button type="submit" class="search-btn">
          <img src="/static/images/lupa.png" alt="Buscar" class="search-icon">
        </button>
      </form>
    </div>
    

  </div>

  <div class="nav-right">
    {% if user %}
    <div class="cart-btn" id="cart-btn">
      <img src="static/images/carrito.png" alt="Carrito" id="cartIcon">
      <!-- Nuevo contador -->
      <span id="cart-count" class="cart-count">0</span>
      <!-- Dropdown que se mostrar√° al pasar el rat√≥n -->
      <div class="cart-dropdown" id="cart-dropdown">
        <!-- El contenido se inyecta din√°micamente -->
      </div>
    </div>   
    
    
    <!-- Perfil de usuario con dropdown -->

    
    <!-- Si el usuario ha iniciado sesi√≥n, se muestra el perfil -->
    <div class="profile-container" id="profileContainer">
      <img src="{{ user.profilePic }}" alt="Perfil" class="profile-icon" id="profileIcon" />

      <div class="profile-dropdown" id="profileDropdown">
      
        <a href="/edit_perfil">Editar perfil</a>
        <a href="/favoritos">Lista de Me gusta</a>
        <a href="/mis_compras">Mis compras</a>

        {% if user.tipo_usuario == "artist" %}
          <a href="/albumes_subidos">√Ålbumes subidos</a>
          <a href="/canciones_subidas">Canciones subidas</a>
        {% endif %}
        {% if user.tipo_usuario == "sello" %}
          <a href="/gestion_sello">Gestionar sello</a>
        {% endif %}

        <a href="/amigos">Gestionar amigos</a>
        <a href="/logout" class="logout-link">Cerrar sesi√≥n</a>
      </div>
    </div>
    
    {% else %}
      <!-- Si NO ha iniciado sesi√≥n, se muestra el bot√≥n de login -->
      <a href="/login" id="loginLink" class="login-btn" title="Iniciar sesi√≥n">Iniciar sesi√≥n</a>
    {% endif %}

  </div>
  
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      // ‚Äî Perfil de usuario ‚Äî
      const profileContainer = document.getElementById('profileContainer');
      const profileIcon      = document.getElementById('profileIcon');
      profileIcon.addEventListener('click', e => {
        e.stopPropagation();
        profileContainer.classList.toggle('active');
      });
  
      // ‚Äî Carrito ‚Äî
      const cartContainer = document.getElementById('cart-btn');
      const cartIcon      = document.getElementById('cartIcon');
      cartIcon.addEventListener('click', e => {
        e.stopPropagation();
        cartContainer.classList.toggle('active');
      });
  
      // Cerrar cualquiera de los dos al clicar fuera
      document.addEventListener('click', e => {
        if (!profileContainer.contains(e.target)) {
          profileContainer.classList.remove('active');
        }
        if (!cartContainer.contains(e.target)) {
          cartContainer.classList.remove('active');
        }
      });
    });
  </script>
  
  

</header>
