<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>UnderSounds - Inicio</title>
  <!-- Fuente moderna y redondeada -->
  <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;700&display=swap" rel="stylesheet">
  
  <!-- Aquí enlazamos el CSS con la nueva maquetación y efectos -->
  <link rel="stylesheet" href="/static/css/styles.css">
</head>

<body>
  {% include "header.html" %}
  <script>
    document.addEventListener("DOMContentLoaded", function () {
      updateCartCount();
      updateCartDropdown();
    });
  </script>



  <!-- Script para evitar el scroll automático al cargar la página -->
  <script>
    window.addEventListener('load', () => {
      setTimeout(() => {
        window.scrollTo(0, 0);
      }, 10); // Espera breve para asegurar que el navegador no haga scroll automático
    });
  </script>




  <!-- Menú de pestañas: Sugerencias, Best Of's, Tienda, Amigos -->
  <div class="tabs">
    <button class="tab active" data-tab="sugerencias">Sugerencias</button>
    <button class="tab" data-tab="bestofs">Best Of's</button>
    <a href="/tienda" class="tab">Tienda</a>
    <a href="/amigos" class="tab">Amigos</a>
  </div>

  <main class="index">
  <!-- Sección: Sugerencias (visible por defecto) -->
    <section id="sugerencias" class="tab-content active">
      <h2 class="logo">Sugerencias</h2>
      <div class="music-section">
        <!-- Canciones Sugerencias -->
        <h3>Canciones Sugeridas</h3>
        <div class="row">
        </div>
      </div>
      <div class="album-section">
        <!-- Albumes Sugerencias -->
        <h3>Álbumes Sugeridos</h3>
        <div class="row">
        </div>
      </div>
      <!-- Géneros Sugerencias -->
      <div class="genres-section">
        <h3>Géneros Sugeridos</h3>
        <div class="row">
        </div>
      </div>
      
    </section>

  <!-- Sección: Best Of's -->
  <section id="bestofs" class="tab-content">
    <h2 class="logo">Best Of's</h2>
    
    <!-- Mejores Canciones -->
    <div class="bestofs-songs">
      <h3>Mejores Canciones</h3>
      <div class="row">
      </div>
    </div>
    <!-- Mejores Álbumes -->
    <div class="album-section">
      <h3>Mejores Álbumes</h3>
      <div class="row"> 
      </div>
    </div>
    <!-- Mejores Generos -->
    <div class="genres-section">
      <h3>Mejores Géneros</h3>
      <div class="row">
      </div>
    </main>
    </section>

  <!-- Botón de Ayuda Flotante -->
  <a href="/ayuda" class="help-button" title="Ayuda">?</a>


  {% include "footer.html" %}

      <!-- Datos para Sugerencias -->
  <div id="data-sugerencias"
  data-canciones='{{ canciones | tojson }}'
  data-albumes='{{ albumes  | tojson }}'
  data-generos='{{ generos  | tojson }}'>
</div>
<!-- Script que selecciona y renderiza al azar -->
<script src="/static/js/index.js"></script>


  <!-- Scripts -->
  <script src="/static/js/main.js"></script>
  <script src="/static/js/app.js"></script>



<!-- Cambios de pantalla entre sugerencias y bestof-->
<script>
  // Esperar a que el DOM esté completamente cargado
  document.addEventListener('DOMContentLoaded', () => {

    // Seleccionar todos los botones de pestaña que tienen el atributo data-tab
    const tabs = document.querySelectorAll('.tab[data-tab]');

    // Seleccionar todas las secciones de contenido que corresponden a las pestañas
    const contents = document.querySelectorAll('.tab-content');

    // Función que muestra la pestaña activa y oculta las demás
    function showTab(tabName) {
      // Recorrer todas las pestañas para activar solo la que corresponde
      tabs.forEach(t => {
        const isActive = t.dataset.tab === tabName;
        t.classList.toggle('active', isActive); // Agrega o quita clase 'active'
      });

      // Mostrar solo el contenido relacionado a la pestaña activa
      contents.forEach(c => {
        const isCurrent = c.id === tabName;
        c.classList.toggle('active', isCurrent);
        c.style.display = isCurrent ? 'block' : 'none'; // Mostrar u ocultar
      });
    }

    // Al cargar la página, detectar si hay un hash (#bestofs, #sugerencias, etc.)
    // Si no hay, por defecto se muestra 'sugerencias'
    const initialTab = window.location.hash.replace('#', '') || 'sugerencias';
    showTab(initialTab); // Mostrar pestaña inicial

    // IMPORTANTE: reemplazar el hash en la URL sin hacer scroll
    history.replaceState(null, null, '#' + initialTab);

    // Agregar evento de clic a cada pestaña
    tabs.forEach(tab => {
      tab.addEventListener('click', () => {
        const selectedTab = tab.dataset.tab;

        // Actualizar el hash en la URL (esto también permite compartir el link)
        // Reemplazar el hash sin scroll automático
        history.replaceState(null, null, '#' + selectedTab);

        // Mostrar la pestaña seleccionada
        showTab(selectedTab);
      });
    });
  });
</script>




  <script>
    // Función para inicializar o verificar la sesión
    function iniciarOValidarSesion() {
      const sessionStart = localStorage.getItem('sessionStart');

      if (!document.referrer) {
        localStorage.clear();
        console.log("localStorage borrado: acceso directo a index.html.");
        // Se establece la hora de inicio de sesión
        localStorage.setItem('sessionStart', Date.now());
      } else {
        console.log("index.html accedido desde otra página, no se borra localStorage.");
      }
    }

    // Ejecutar la verificación al cargar la página
    document.addEventListener('DOMContentLoaded', function() {
      iniciarOValidarSesion();
    });
  </script>

</body>
</html>
