<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>UnderSounds - Inicio</title>
  <!-- Fuente moderna y redondeada -->
  <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;700&display=swap" rel="stylesheet">
  
  <!-- Aquí enlazamos el CSS con la nueva maquetación y efectos -->
  <link rel="stylesheet" href="/static/css/styles.css">
</head>

<body>
  <!-- Inyección del header 
  <div id="header-placeholder"></div>
  <script>
    fetch('/partials/header.html')
      .then(response => response.text())
      .then(data => {
        document.getElementById('header-placeholder').innerHTML = data;
        // Después de cargar el header, inicializamos el carrito
        setTimeout(() => {
          updateCartCount();
          updateCartDropdown();
        }, 100);
      });
  </script>
  -->

  {% include "header.html" %}
  <script>
    document.addEventListener("DOMContentLoaded", function () {
      updateCartCount();
      updateCartDropdown();
    });
  </script>



  <!-- Script para evitar el scroll automático al cargar la página -->
  <script>
    window.addEventListener('load', () => {
      setTimeout(() => {
        window.scrollTo(0, 0);
      }, 10); // Espera breve para asegurar que el navegador no haga scroll automático
    });
  </script>




  <!-- Menú de pestañas: Recientes, Best Of's, Tienda, Amigos -->
  <div class="tabs">
    <button class="tab active" data-tab="recientes">Recientes</button>
    <button class="tab" data-tab="bestofs">Best Of's</button>
    <a href="/tienda" class="tab">Tienda</a>
    <a href="/amigos" class="tab">Amigos</a>
  </div>

  <main class="index">
  <!-- Sección: Recientes (visible por defecto) -->
    <section id="recientes" class="tab-content active">
      <h2 class="logo">Recientes</h2>
      <div class="music-section">
        <!-- Canciones Recientes -->
        <h3>Canciones Recientes</h3>
        <div class="row">
          <a href="/cancion?id=1" class="card">
            <img src="static/images/bohemian.jpeg" alt="Bohemian Rhapsody" class="card-img">
            <div class="card-caption">Bohemian Rhapsody</div>
          </a>
          <a href="/cancion?id=2" class="card">
            <img src="static/images/lights.jpeg" alt="Blinding Lights" class="card-img">
            <div class="card-caption">Blinding Lights</div>
          </a>
          <a href="/cancion?id=3" class="card">
            <img src="static/images/animals.jpeg" alt="Animals" class="card-img">
            <div class="card-caption">Animals</div>
          </a>
          <a href="/cancion?id=4" class="card">
            <img src="static/images/five.jpeg" alt="Take Five" class="card-img">
            <div class="card-caption">Take Five</div>
          </a>
        </div>
      </div>
      <div class="album-section">
        <h3>Álbumes Recientes</h3>
        <div class="row">
          <a href="/album?id=1" class="card">
            <img src="static/images/opera.jpeg" alt="A Night at the Opera" class="card-img">
            <div class="card-caption">A Night at the Opera</div>
          </a>
          <a href="/album?id=6" class="card">
            <img src="static/images/futuro.jpeg" alt="Future Nostalgia" class="card-img">
            <div class="card-caption">Future Nostalgia</div>
          </a>
          <a href="/album?id=3" class="card">
            <img src="static/images/x100pre.jpeg" alt="X 100pre" class="card-img">
            <div class="card-caption">X 100pre</div>
          </a>
          <a href="/album?id=7" class="card">
            <img src="static/images/vibras.jpeg" alt="Vibras" class="card-img">
            <div class="card-caption">Vibras</div>
          </a>
        </div>
      </div>
      

      <!-- Géneros Recientes -->
      <div class="genres-section">
        <h3>Géneros Recientes</h3>
        <div class="row">
          <a href="/generos_especifico?id=rock" class="card">
            <img src="static/images/rock.jpeg" alt="Rock" class="card-img">
            <div class="card-caption">Rock</div>
          </a>
          <a href="/generos_especifico?id=pop" class="card">
            <img src="static/images/pop.jpeg" alt="Pop" class="card-img">
            <div class="card-caption">Pop</div>
          </a>
          <a href="/generos_especifico?id=electronica" class="card">
            <img src="static/images/electro.jpeg" alt="Electrónica" class="card-img">
            <div class="card-caption">Electrónica</div>
          </a>
          <a href="/generos_especifico?id=jazz" class="card">
            <img src="static/images/jazz.png" alt="Jazz" class="card-img">
            <div class="card-caption">Jazz</div>
          </a>
        </div>
      </div>
      
    </section>

  <!-- Sección: Best Of's -->
  <section id="bestofs" class="tab-content">
    <h2 class="logo">Best Of's</h2>
    
    <!-- Mejores Canciones -->
    <div class="bestofs-songs">
      <h3>Mejores Canciones</h3>
      <div class="row">
        <a href="/cancion?id=7" class="card">
          <img src="static/images/karol-g.jpeg" alt="Tusa" class="card-img">
          <div class="card-caption">Tusa</div>
        </a>
        <a href="/cancion?id=10" class="card">
          <img src="static/images/ariana-grande.jpeg" alt="Positions" class="card-img">
          <div class="card-caption">Positions</div>
        </a>
        <a href="/cancion?id=8" class="card">
          <img src="static/images/david-guetta.jpeg" alt="Titanium" class="card-img">
          <div class="card-caption">Titanium</div>
        </a>
        <a href="/cancion?id=9" class="card">
          <img src="static/images/foo-fighters.jpg" alt="Everlong" class="card-img">
          <div class="card-caption">Everlong</div>
        </a>
      </div>
    </div>
    
    
    <!-- Mejores Álbumes -->
    <div class="album-section">
      <h3>Mejores Álbumes</h3>
      <div class="row">
        <a href="/album?id=5" class="card">
          <img src="static/images/parachutes.jpg" alt="Parachutes" class="card-img">
          <div class="card-caption">Parachutes</div>
        </a>
        <a href="/album?id=8" class="card">
          <img src="static/images/18months.jpg" alt="18 Months" class="card-img">
          <div class="card-caption">18 Months</div>
        </a>
        <a href="/album?id=11" class="card">
          <img src="static/images/kg0516.jpeg" alt="KG0516" class="card-img">
          <div class="card-caption">KG0516</div>
        </a>
        <a href="/album?id=9" class="card">
          <img src="static/images/thecolourandtheshape.jpg" alt="The Colour and the Shape" class="card-img">
          <div class="card-caption">The Colour and the Shape</div>
        </a>
      </div>
    </div>
    
    <div class="genres-section">
      <h3>Mejores Géneros</h3>
      <div class="row">
        <a href="/generos_especifico?id=reggaeton" class="card">
          <img src="static/images/reggaeton.jpeg" alt="Reggaeton" class="card-img">
          <div class="card-caption">Reggaeton</div>
        </a>
        <a href="/generos_especifico?id=techno" class="card">
          <img src="static/images/techno.jpg" alt="Techno" class="card-img">
          <div class="card-caption">Techno</div>
        </a>
        <a href="/generos_especifico?id=hiphop" class="card">
          <img src="static/images/hip_hop.jpg" alt="Hip Hop" class="card-img">
          <div class="card-caption">Hip Hop</div>
        </a>
        <a href="/generos_especifico?id=salsa" class="card">
          <img src="static/images/salsa.jpg" alt="Salsa" class="card-img">
          <div class="card-caption">Salsa</div>
        </a>
      </div>
    </main>
    </section>

  <!-- Botón de Ayuda Flotante -->
  <a href="/ayuda" class="help-button" title="Ayuda">?</a>



  <!-- Contenedor para insertar el footer dinámicamente 
  <div id="footer"></div>

   Script para cargar footer.html 
  <script>
    // Esta función "fetch" trae el contenido de footer.html
    // y lo inyecta dentro del div con id="footer"
    fetch('footer.html')
      .then(response => response.text())
      .then(data => {
        document.getElementById('footer').innerHTML = data;
      })
      .catch(error => {
        console.error('Error al cargar el footer:', error);
      });
  </script>-->

  {% include "footer.html" %}



  <!-- Scripts -->
  <script src="/static/js/main.js"></script>
  <script src="/static/js/app.js"></script>



<!-- Cambios de pantalla entre recientes y bestof-->
<script>
  // Esperar a que el DOM esté completamente cargado
  document.addEventListener('DOMContentLoaded', () => {

    // Seleccionar todos los botones de pestaña que tienen el atributo data-tab
    const tabs = document.querySelectorAll('.tab[data-tab]');

    // Seleccionar todas las secciones de contenido que corresponden a las pestañas
    const contents = document.querySelectorAll('.tab-content');

    // Función que muestra la pestaña activa y oculta las demás
    function showTab(tabName) {
      // Recorrer todas las pestañas para activar solo la que corresponde
      tabs.forEach(t => {
        const isActive = t.dataset.tab === tabName;
        t.classList.toggle('active', isActive); // Agrega o quita clase 'active'
      });

      // Mostrar solo el contenido relacionado a la pestaña activa
      contents.forEach(c => {
        const isCurrent = c.id === tabName;
        c.classList.toggle('active', isCurrent);
        c.style.display = isCurrent ? 'block' : 'none'; // Mostrar u ocultar
      });
    }

    // Al cargar la página, detectar si hay un hash (#bestofs, #recientes, etc.)
    // Si no hay, por defecto se muestra 'recientes'
    const initialTab = window.location.hash.replace('#', '') || 'recientes';
    showTab(initialTab); // Mostrar pestaña inicial

    // IMPORTANTE: reemplazar el hash en la URL sin hacer scroll
    history.replaceState(null, null, '#' + initialTab);

    // Agregar evento de clic a cada pestaña
    tabs.forEach(tab => {
      tab.addEventListener('click', () => {
        const selectedTab = tab.dataset.tab;

        // Actualizar el hash en la URL (esto también permite compartir el link)
        // Reemplazar el hash sin scroll automático
        history.replaceState(null, null, '#' + selectedTab);

        // Mostrar la pestaña seleccionada
        showTab(selectedTab);
      });
    });
  });
</script>




  <script>
    // Función para inicializar o verificar la sesión
    function iniciarOValidarSesion() {
      const sessionStart = localStorage.getItem('sessionStart');

      if (!document.referrer) {
        localStorage.clear();
        console.log("localStorage borrado: acceso directo a index.html.");
        // Se establece la hora de inicio de sesión
        localStorage.setItem('sessionStart', Date.now());
      } else {
        console.log("index.html accedido desde otra página, no se borra localStorage.");
      }
    }

    // Ejecutar la verificación al cargar la página
    document.addEventListener('DOMContentLoaded', function() {
      iniciarOValidarSesion();
    });
  </script>

</body>
</html>
